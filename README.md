NeurIPS'19-MV-Kumaraswamy
==========

Code for reproducing some key results of our NeurIPS 2019 submission.

**A New Distribution on the Simplex with Auto-Encoding Applications**  

## Prerequisites

1. Python (version 3.6.7 or higher)

2. Python requirements are captured in `requirements.txt`
	- For GPU accelerated TensorFlow: 
	    - run `pip install -r requirements.txt`
	- For CPU TensorFlow:
	    - Change `tensorflow-gpu` to `tensorflow` in `requirements.txt`
	    - run `pip install -r requirements.txt`

## Retrieving Data Sets

We utilize the [TensorFlow Datasets API](https://www.tensorflow.org/datasets/). Running any of our code that requires data will automatically download the requisite data.

## Repository Overview

- Experiment Scripts
    - `experiments_ss_run.py` runs ours semi-supervised learning experiments.
    - `experiments_ss_analyze.py` analyzes the results generated by `experiments_ss_run.py`.
- Multivariate Kumaraswamy Code
    - `kumar_sampler.py` contains a TensorFlow implementation of the Multivariate Kumaraswamy.
    - `kumar_theory.py` contains a symbolic implementation of stick-breaking process that supports Beta and Kumaraswamy distributions.
- Model Files
    - `models_proposed.py` contains our proposed models classes:
        - `AutoEncodingCommon` a common object shared for all models,
        - `AutoEncodingDirichlet` for dim(z) = 0
        - `AutoEncodingDirichletNormal` for dim(z) > 0
    - `models_baseline.py` contains our baseline models classes:
        - `KingmaM2` for dim(z) > 0
        - `AutoEncodingSoftmax` for dim(z) = 0
        - `AutoEncodingSoftmaxNormal` for dim(z) > 0
    - `model_lib.py` contains functions used to construct the inference and recognition network operations.
    - `model_utils.py` contains data loading/splitting, training routines, and other support functions.
- Miscellaneous
    - `unit_test.py` 

## Reproducing Report Images

- `python kumar_sampler.py` will plot and show Figure 1 (among other non-utilized figures).
- `python kumar_theory.py` will plot and show Figures 2-4 (among other non-utilized figures).
- Figure 5 can be generated multiple ways:
    - `python model_utils.py` will plot and show something similar to Figure 5.
    - `python experiments_ss_run.py --data_set mnist --num_labelled 600 --dim_z 50` will save something similar to Figure 5 for each training epoch into a timestamped results folder.

## Reproducing Experimental Results

- Table 1:
    - First run and wait for completion:
        - `python experiments_ss_run.py --num_runs 10 --data_set mnist --num_labelled 600 --dim_z 0`
        - `python experiments_ss_run.py --num_runs 10 --data_set mnist --num_labelled 600 --dim_z 2`
        - `python experiments_ss_run.py --num_runs 10 --data_set mnist --num_labelled 600 --dim_z 50`
    - Second run:
        - `python experiments_ss_analyze.py --data_set mnist`     
        
- Table 2:
    - First run and wait for completion:
        - `python experiments_ss_run.py --num_runs 4 --data_set svhn_cropped --num_labelled 1000 --dim_z 50`
    - Second run:
        - `python experiments_ss_analyze.py --data_set svhn_cropped`  
